<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="../css/style.css">
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <title>星座运势</title>
</head>

<body>
    <div class="warp" id='result'>
        <div class="topHeader">
            <div class="topContent">
                <a href="#" class="topHeaderLeft" onClick="javascript :history.back(-1)">
                    <img src="../img/arr-left.png" alt="" srcset="">
                </a>
                <span href="" class="headerTittle">星座解析</span>
                <a href="#" @Click="btnDialog">
                    <img src="../img/share.png" alt="" srcset="">
                </a>
            </div>
        </div>

        <div class="XZ-Analysis">
            <div class="XZ-Analysis-Top">
                <img :src="xzItem.big_logo" alt="" srcset="">
                <span> {{xzItem.name}}</span>
                <span> {{xzItem.betweens}}</span>
            </div>
        </div>

        <div class="XZ-AnalysisMiddle">
            <div class="XZ-AnalysisMiddle-Content">
                <ul class="XZ-item">
                    <li>
                        <span>幸运值</span>
                        <p>{{xzList.xyz}}</p>
                    </li>
                    <li>
                        <span>爱情指数</span>
                        <p>{{xzList.aqzs}}</p>
                    </li>
                    <li>
                        <span>工作指数</span>
                        <p>{{xzList.gzzs}}</p>
                    </li>
                    <li>
                        <span>财运指数</span>
                        <p>{{xzList.cyzs}}</p>
                    </li>
                    <li>
                        <span>健康指数</span>
                        <p>{{xzList.jkzs}}</p>
                    </li>
                    <li>
                        <span>幸运数字</span>
                        <p>{{xzList.xysz}}</p>
                    </li>
                    <li>
                        <span>幸运颜色</span>
                        <p>{{xzList.color}}</p>
                    </li>
                    <li>
                        <span>贵人星座</span>
                        <p>{{xzList.peixz}}</p>
                    </li>
                </ul>
            </div>
            <div class="XZ-fenxi">

                <div class="XZ-fenxi-top">
                    <h1>综合运势</h1>
                    <div>
                        <img :src="v" alt="" srcset="" v-for='(v,i) in xzList.zh_zs' :key='i'>
                    </div>
                </div>
                <div class="XZ-fenxi-content">{{xzList.zhys}}</div>
            </div>

            <div class="XZ-fenxi">
                <div class="XZ-fenxi-top">
                    <h1>爱情运势</h1>
                    <div>
                        <img :src="v" alt="" srcset="" v-for='(v,i) in xzList.ay_zs' :key='i'>
                    </div>
                </div>
                <div class="XZ-fenxi-content">{{xzList.aqys}}</div>
            </div>

            <div class="XZ-fenxi">
                <div class="XZ-fenxi-top">
                    <h1>事业运势</h1>
                    <div>
                        <img :src="v" alt="" srcset="" v-for='(v,i) in xzList.sy_zs' :key='i'>

                    </div>
                </div>
                <div class="XZ-fenxi-content">{{xzList.syys}}</div>
            </div>
            <div class="XZ-fenxi">
                <div class="XZ-fenxi-top">
                    <h1>财富运势</h1>
                    <div>
                        <img :src="v" alt="" srcset="" v-for='(v,i) in xzList.cf_zs' :key='i'>
                    </div>
                </div>
                <div class="XZ-fenxi-content">{{xzList.cfys}}</div>
            </div>
            <div class="XZ-fenxi">
                <div class="XZ-fenxi-top">
                    <h1>健康运势</h1>
                    <div>
                        <img :src="v" alt="" srcset="" v-for='(v,i) in xzList.jk_zs' :key='i'>

                    </div>
                </div>
                <div class="XZ-fenxi-content">{{xzList.jkys}}</div>
            </div>

        </div>
        <!-- 弹框 -->
        <div class="HH-Dialog " v-show='tankuang' ref="addImage">
            <div class="content XZ-Dialog-Bg" ref="capture">
                <div class="content-close">
                    <img src="../img/close.png" alt="" @click="hideDialog">
                </div>
                <div class="content-tittle pt30">星座解析</div>
                <div class="content-text">
                    {{xzList.zhys}}

                </div>
                <div class="HH-code">
                    <p><span>13</span>2020 Sept.</p>
                    <img src="../img/code.png" alt="" srcset="">
                </div>

                <div class="footer XZ-footerBg down" @click="generatorImage">保存到相册转发朋友圈或好友</div>
            </div>

        </div>
    </div>



    <!-- <script src="../js/html2canvas.js"></script> -->
    <script src="../js/html2canvas.min.js"></script>
    <script src="../js/jquery-3.4.1.js"></script>
    <!-- <script>
        $(function () {
            $(".down").click(function () {
                alert('1111')
                html2canvas($(".HH-Dialog")[0]).then(function (canvas) {
                    var imgUri = canvas.toDataURL("image/png").replace("image/png",
                        "image/octet-stream"); // 获取生成的图片的url
                    window.location.href = imgUri; // 下载图片
                });

            });
        });
    </script> -->


    <script src="https://cdn.staticfile.org/vue/2.4.2/vue.min.js"></script>
    <script>
        var vue = new Vue({
            el: '#result',
            data: {
                xzItem: [],
                xzList: [],
                tankuang: false,

            },
            methods: {
                hideDialog() {
                    this.tankuang = false
                },
                btnDialog() {

                    this.tankuang = true;
                },
                generatorImage() {
                    html2canvas(this.$refs.capture).then(canvas => {

                        // this.$refs.addImage.append(canvas) // 这个我没有加，看其他的文章有，但是我加上会有其他的问题，就取消了
                        let link = document.createElement('a') // 创建a标签
                        link.href = canvas.toDataURL() // 是canvas对象的一种方法，用于将canvas对象转换为base64位编码
                        link.setAttribute('download', '图片canvas.png') // 利用了a标签的download 来下载 canvas图片
                        link.style.display = 'none' //将图片隐藏起来
                        document.body.appendChild(link) //插入到其中
                        link.click()
                    })
                }
            },

            mounted: function () {

                //星座解析
                axios.post('http://h5.anhuiqingyou.com/xingzuo/info', {
                        id: localStorage.getItem('id')
                    })
                    .then((res) => {
                        console.log(res, '星座解析')
                        if (res.data.code == 0) {
                            this.xzItem = res.data.data.xingzuo
                            this.xzList = res.data.data.today_info
                        }

                    })
                    .catch(function (error) {
                        console.log(error);
                    });
            },

        })
    </script>





</body>

</html>